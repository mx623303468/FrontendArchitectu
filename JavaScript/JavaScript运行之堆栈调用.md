## JavaScript运行之堆栈调用

JavaScript 代码能够运行，肯定需要一个运行环境，目前常见的 JavaScript 运行环境有：

- 浏览器（V8引擎或者其他浏览器引擎）
- nodejs
- webview
- ....其他类型的运行环境

能够运行代码的执行环境叫做 **执行环境栈 / ECStack(Execution Context Stack)** 

在执行栈中运行的代码分为： 

- 全局代码块 ： 只有一个，指向最顶层，浏览器中指向 `window`
- 函数中的代码块：每个函数包含的代码块，函数执行时会创建一个执行上下文
- Eval函数中的代码块：在 eval 函数中运行的代码块

不同的代码块，执行的时候都有自己的**上下文 / EC(Execution Context) **

全局执行的代码块的执行上下文称为 **全局执行上下文 / EC(G) global**

**全局执行上下文** 包含 **全局变量对象VO(G) / Varibale Object**



当执行 JavaScript 代码时，会创建一个 **全局执行上下文 / EC(G) global** 放入**执行环境栈 / ECStack(Execution Context Stack)**  中。



在创建完毕上下文后，进入语法解析阶段，确定 This 指向，记录执行环境。

之后进行值储存，变量声明，然后把值的储存地址指向变量。

代码的执行顺序，永远是先储存值，在声明变量，切值只能新建，不能修改，变量的值修改，只是改变值的引用地址。

以上的操作都时栈内存中完成的。

而引用数据类型的值，不会在栈内存中存储，而是在堆内存中开辟一个空间，每个空间都有一个16进制的内存地址来供变量调用。

此时一个简单的堆栈调用就完成了。